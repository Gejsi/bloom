org: gejsi
app: funx
service: funx
frameworkVersion: "3"
provider:
  name: aws
  runtime: nodejs14.x
  region: eu-central-1
  environment:
    MY_SECRET: ${file(./config.${opt:stage, 'dev'}.json):CREDS}
  iamRoleStatements:
    - Effect: Allow
      Action:
        - lambda:InvokeFunction
        - lambda:InvokeAsync
      Resource: "*"
functions:
  hi:
    handler: hello.hi
  hello:
    handler: hello.greet
  createUser:
    handler: fetch.createUser
    events:
      - httpApi:
          method: POST
          path: /users/create
      - httpApi:
          method: PUT
          path: 3
  getUser:
    handler: fetch.getUser
    events:
      - schedule:
          rate: cron(0 12 * * ? *)
          enabled:
            - Three
            - 2
            - First
          inputTransfomer:
            inputPathsMap:
              eventTime: $.time
            inputTemplate: '{"time": <eventTime>, "key1": "value1"}'
  processOrder:
    handler: fetch.processOrder
    events:
      - schedule:
          rate: cron(0 11 * * ? *)
          enabled: false
          foo:
            - One
            - 2
            - Three
          inputTransfomer:
            inputPathsMap:
              eventTime: $.time
            inputTemplate: '{"time": <eventTime>, "key1": "value1"}'
plugins:
  - serverless-offline
  - serverless-esbuild
